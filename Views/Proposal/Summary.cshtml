@model FSSA.Models.MyProposalViewModel

@{
    ViewData["Title"] = "Proposal Summary";
}

<h2>@Model.Title</h2>

<div class="d-flex gap-2 mt-3">
    <a class="btn btn-dark" asp-action="Search">Back to Proposals</a>
    <a class="btn btn-warning" asp-action="Details" asp-route-id="@Model.Id">Detail View</a>
</div>

<div class="summary-section">
    <dl class="row">
        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.SubmittedByName)</dt>
        <dd class="col-sm-9">@Model.SubmittedByName</dd>

        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.StatusName)</dt>
        <dd class="col-sm-9">@Model.StatusName</dd>

        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.ProjectLevel)</dt>
        <dd class="col-sm-9">@Model.ProjectLevel</dd>

        <!-- Synopsis -->
        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.Synopsis)</dt>
        <dd class="col-sm-9">
            @if (!string.IsNullOrWhiteSpace(Model.Synopsis))
            {
                <span id="synopsisPreview">
                    @(Model.Synopsis.Length > 50 ? Model.Synopsis[..50] + "..." : Model.Synopsis)
                    <a href="#" onclick="toggle('synopsis'); return false;">View More</a>
                </span>
                <span id="synopsisFull" style="display:none;">
                    @Model.Synopsis
                    <a href="#" onclick="toggle('synopsis'); return false;">View Less</a>
                </span>
            }
            else { <span>(No Synopsis Data Provided)</span> }
        </dd>

        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.Method)</dt>
        <dd class="col-sm-9">
            @if (!string.IsNullOrWhiteSpace(Model.Method))
            {
                <span id="methodPreview">
                    @(Model.Method.Length > 50 ? Model.Method[..50] + "..." : Model.Method)
                    <a href="#" onclick="toggle('method'); return false;">View More</a>
                </span>
                <span id="methodFull" style="display:none;">
                    @Model.Method
                    <a href="#" onclick="toggle('method'); return false;">View Less</a>
                </span>
            }
            else { <span>(No data available)</span> }
        </dd>

        <!-- Outcomes -->
        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.Outcomes)</dt>
        <dd class="col-sm-9">
            @if (!string.IsNullOrWhiteSpace(Model.Outcomes))
            {
                <span id="outcomesPreview">
                    @(Model.Outcomes.Length > 50 ? Model.Outcomes[..50] + "..." : Model.Outcomes)
                    <a href="#" onclick="toggle('outcomes'); return false;">View More</a>
                </span>
                <span id="outcomesFull" style="display:none;">
                    @Model.Outcomes
                    <a href="#" onclick="toggle('outcomes'); return false;">View Less</a>
                </span>
            }
            else { <span>(No data available)</span> }
        </dd>

        <!-- Physical Resources -->
        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.PhysicalResources)</dt>
        <dd class="col-sm-9">
            @(!string.IsNullOrWhiteSpace(Model.PhysicalResources)
                ? Model.PhysicalResources
                : "(No data available)")
        </dd>

        <!-- Financial Resources -->
        <dt class="col-sm-3">Financial Resources</dt>
        <dd class="col-sm-9">
            @if (Model.FinancialResources != null && Model.FinancialResources.Any())
            {
                <ul class="list-unstyled">
                    @foreach (var fr in Model.FinancialResources)
                    {
                        <li>- @fr.Title (@fr.Cost.ToString("C"))</li>
                    }
                </ul>
            }
            else
            {
                <span>(No financial resources listed)</span>
            }
        </dd>

        <!-- Ethical Considerations -->
        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.EthicalConsiderations)</dt>
        <dd class="col-sm-9">@(!string.IsNullOrWhiteSpace(Model.EthicalConsiderations) ? Model.EthicalConsiderations : "(No data available)")</dd>

        <!-- Milestones -->
        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.Milestones)</dt>
        <dd class="col-sm-9">@(!string.IsNullOrWhiteSpace(Model.Milestones) ? Model.Milestones : "(No data available)")</dd>

        <!-- Estimated Completion Date -->
        <dt class="col-sm-3">@Html.DisplayNameFor(m => m.EstimatedCompletionDate)</dt>
        <dd class="col-sm-9">@((Model.EstimatedCompletionDate != DateTime.MinValue) ? Model.EstimatedCompletionDate.ToString("yyyy-MM-dd") : "(No date provided)")</dd>
    </dl>
</div>

@section Scripts {
    <script>
        function toggle(section) {
            const preview = document.getElementById(section + 'Preview');
            const full = document.getElementById(section + 'Full');
            if (preview && full) {
                const isVisible = preview.style.display !== 'none';
                preview.style.display = isVisible ? 'none' : '';
                full.style.display = isVisible ? '' : 'none';
            }
        }
    </script>
}
